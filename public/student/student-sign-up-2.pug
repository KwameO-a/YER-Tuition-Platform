<!DOCTYPE html><!--  Last Published: Sun Jan 24 2021 21:13:58 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5f98942586b0cd82a6142caf" data-wf-site="5f855b36d840bd0dab33dac0">
<head>
  <meta charset="utf-8">
  <title>Sign up student</title>
  <meta content="Sign up student" property="og:title">
  <meta content="Sign up student" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="/css/components.css" rel="stylesheet" type="text/css">
  <link href="/css/yer-tuition-services.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Nunito:regular,700,800","M PLUS Rounded 1c:regular,700,800"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="/images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="/images/webclip.png" rel="apple-touch-icon">
</head>
<body class="page hidden>
  <div class="login-nav w-clearfix">
    <a href="/" class="brand w-inline-block"></a>
    <div class="div-block-10">
      <a href="/" class="nav-link login">Go Back</a>
      <!-- <a href="#" class="nav-link signup">Sign up</a> -->
    </div>
  </div>
  <div class="sign-up-section w-clearfix">
    <div class="form-column form">
      <div class="sign-up-block w-form">
        <form id="email-form" name="email-form" data-name="Email Form">
          <h1 class="heading-1">Sign up</h1>
          <h1 class="signup-heading-1">Student&#x27;s Detail</h1>
          <div class="form-wrapper w-clearfix">
            <div class="signup-column left">
              <label for="FirstName" class="signup-label">First Name</label>
              <input type="text" class="input-field w-input" maxlength="256" name="FirstName" data-name="Name" placeholder="" id="FirstName">
            </div>
            <div class="signup-column right">
              <label for="Surname" class="signup-label">Surname</label>
              <input type="text" class="input-field w-input" maxlength="256" name="Surname" data-name="Name 2" placeholder="" id="Surname">
            </div>
          </div>
          <div class="form-wrapper">
            <label for="StudentSchool" class="signup-label">Student&#x27;s school</label>
            <input type="text" class="input-field w-input" maxlength="256" name="StudentSchool" data-name="Wa1" placeholder="" id="StudentSchool" required="">
          </div>
          <div class="form-wrapper">
            <label for="KeyStage" class="signup-label">SHS</label>
            <select id="KeyStage" name="KeyStage" data-name="Field" class="input-field selector w-select">
              <option value="SHS 1">SHS 1</option>
              <option value="SHS 2">SHS 2</option>
              <option value="SHS 3">SHS 3</option>
            </select>
          </div>
          <div class="form-wrapper">
            <label for="CurrentExamBoard" class="signup-label">Exam board student currently studies</label>
            <input type="text" class="input-field w-input" maxlength="256" name="CurrentExamBoard" data-name="Wa1" placeholder="" id="CurrentExamBoard" required="">
          </div>
          <div class="form-wrapper">
            <label for="SupportNeeded" class="signup-label">What the student needs support with (be specific by topic)</label>
            <input type="text" class="input-field w-input" maxlength="256" name="SupportNeeded" data-name="Wa1" placeholder="" id="SupportNeeded" required="">
          </div>
          <div class="form-wrapper">
            <label for="RelationshipToStudent" class="signup-label">Relationship to student</label>
            <input type="text" class="input-field w-input" maxlength="256" name="RelationshipToStudent" data-name="Wa1" placeholder="" id="RelationshipToStudent" required="">
          </div>
          <div class="form-wrapper">
            <label for="StudentEmail" class="signup-label">Student&#x27;s email address (optional)</label>
            <input type="text" class="input-field w-input" maxlength="256" name="StudentEmail" data-name="Wa1" placeholder="" id="StudentEmail" required="">
          </div>
          <div class="form-wrapper buttons">
            <a href="/student/signup/1" class="button signup-back w-button">Back</a>
            <a href="#" class="button signup-next signup-finish w-button">Register</a>
          </div>
        </form>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        <div class="w-form-fail">
          <div>Oops! Something went wrong while submitting the form.</div>
        </div>
      </div>
    </div>
    <div class="form-column student"></div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=5f855b36d840bd0dab33dac0" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="/js/yer-tuition-services.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
  <!-- <script src="https://cdn.auth0.com/js/auth0-spa-js/1.2/auth0-spa-js.production.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script src="/js/ui.js"></script>
  <script src="/js/app.js"></script> -->
  <script src="https://cdn.auth0.com/js/auth0/9.11/auth0.min.js"></script>
  script.
    var savedData = localStorage.studentData ? JSON.parse(localStorage.studentData) : false;
    if(savedData) {
      $('#FirstName').val(savedData.FirstName);
      $('#Surname').val(savedData.Surname);
      $('#StudentSchool').val(savedData.StudentSchool);
      $('#KeyStage').val(savedData.KeyStage);
      $('#CurrentExamBoard').val(savedData.CurrentExamBoard);
      $('#SupportNeeded').val(savedData.SupportNeeded);
      $('#RelationshipToStudent').val(savedData.RelationshipToStudent);
      $('#StudentEmail').val(savedData.StudentEmail);
    }

    $('.button.signup-finish').on('click', async function(e) {
      $(this).text("Signing up, please wait ...").attr("disabled", "disabled").addClass("disabled");
      var webAuth = new auth0.WebAuth({
        domain:       'dev-gni4nx9z.us.auth0.com',
        clientID:     'j25SQndxVWGCp2JaMTjdmXQLDy1yoa8h',
        responseType: 'code'
      });
      var studentData = {
        FirstName : $('#FirstName').val(),
        Surname : $('#Surname').val(),
        StudentSchool : $('#StudentSchool').val(),
        KeyStage : $('#KeyStage').val(),
        CurrentExamBoard : $('#CurrentExamBoard').val(),
        SupportNeeded : $('#SupportNeeded').val(),
        RelationshipToStudent : $('#RelationshipToStudent').val(),
        StudentEmail : $('#StudentEmail').val()
      };
      var parentData = JSON.parse(localStorage.parentData);
      Object.keys(studentData).every(function(key, index) {
        if(!studentData[key]) {
          alert("All the fields below are required. Fill them all to continue");
          e.preventDefault();
          return false;
        }
      });

      localStorage.setItem("studentData", JSON.stringify(studentData));
      webAuth.signup({ 
        connection: 'Username-Password-Authentication', 
        email: parentData.Email, 
        password: parentData.Password,
        username: parentData.Email,
        given_name: studentData.FirstName,
        family_name: studentData.Surname,
        name: studentData.FirstName + " " + studentData.Surname,
        nickname: studentData.FirstName.toString().toLowerCase(),
        user_metadata: { plan: 'none', team_id: 'none' },
        app_metadata: { roles : ['student'] }
      }, async function (err) { 
        if (err) {
          if( err.code === "invalid_password") {
            return alert('Weak password selected. Do the following:\n ' + err.policy); 
          } else {
            return alert('Something went wrong: ' + err.description); 
          }
        }
        let userData = { studentData : JSON.parse(localStorage.studentData), parentData : JSON.parse(localStorage.parentData) };
        
        await fetch("/api/signup/student", {
          method : "POST",
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body : JSON.stringify(userData)
        })
        .then(response => response.json())
        .then(data => {
          console.log(data);
          if(data.code === 200)
           localStorage.removeItem("studentData");
           localStorage.removeItem("parentData");
            window.location.href = window.location.origin + "/student/signup/3";
        });

      });
    })
</body>
</html>